USE QLDSV
GO
/** -----Tạo bảng KHOA----- **/
CREATE TABLE KHOA(
	MAKH char(8) NOT NULL PRIMARY KEY,
	TENKH varchar(40) NOT NULL,
)
/** -----Khoa(MAKH,TENKH)----- **/
INSERT KHOA VALUES (N'CNTT', N'Cong nghe thong tin')
INSERT KHOA VALUES (N'VT', N'Vien thong')
GO
/** -----Tạo bảng LOP----- **/
CREATE TABLE LOP(
	MALOP char(8) NOT NULL PRIMARY KEY,
	TENLOP varchar(40) NULL,
	MAKH char(8) NULL,
)
GO
/** -----LOP(MALOP,TENLOP,MAKH)----- **/
INSERT LOP VALUES (N'16050301', N'Cao dang chinh qui CNTT Khoa 19', N'CNTT')
INSERT LOP VALUES (N'16050302', N'Đai hoc chinh qui  CNTT  Khoa 20 ', N'CNTT')
INSERT LOP VALUES (N'16050303', N'Đai hoc chinh qui VT  Khoa 19 ', N'VT  ')
INSERT LOP VALUES (N'16050310', N'Đai hoc chinh qui  CNTT  Khoa 18', N'CNTT')
INSERT LOP VALUES (N'16050304', N'Đai hoc chinh qui  VT  Khoa 20', N'VT  ')

GO
/** -----Tạo bảng MONHOC----- **/
CREATE TABLE MONHOC(
	MAMH char(6) NOT NULL PRIMARY KEY,
	TENMH varchar(40) NULL,
)
GO
/** -----MONHOC(MAMH,TENMH)----- **/
INSERT MONHOC VALUES (N'501043', N'Cau truc du lieu')
INSERT MONHOC VALUES (N'504068', N'Co so du lieu phan tan')
INSERT MONHOC VALUES (N'502051', N'Co so du lieu')
INSERT MONHOC VALUES (N'504076', N'Phat trien tro choi')
INSERT MONHOC VALUES (N'504070', N'Kien truc huong dich vu')
INSERT MONHOC VALUES (N'C01122', N'Dai so tuyen tinh')
INSERT MONHOC VALUES (N'C01123', N'Xac xuat thong ke')
INSERT MONHOC VALUES (N'501044', N'Cau truc roi rac')

GO
/** -----Tạo bảng SINHVIEN----- **/
CREATE TABLE SINHVIEN(
	MASV char(8) PRIMARY KEY NOT NULL ,
	HO varchar(40) NULL,
	TEN varchar(10) NULL,
	MALOP char(8) NOT NULL,
	PHAI bit NULL,
	NGAYSINH datetime NULL,
	NOISINH varchar(40) NULL,
	DIACHI varchar(80) NULL,
	NGHIHOC bit NULL,
)
GO
/** -----SINHVIEN(MASV,HO,TEN,MALOP,PHAI,NGAYSINH,NOISINH,DIACHI,NGHIHOC)----- **/
INSERT SINHVIEN VALUES (N'51603330', N'Nguyen Trung', N'Tinh', N'16050302', 1, CAST(0x0000883300000000 AS DateTime), N'Tien Giang', N'Cho Gao Tien Giang', 0)
INSERT SINHVIEN VALUES (N'51603144', N'Nguyen Tuan', N'Huy', N'16050310', 1, CAST(0x0000882600000000 AS DateTime), N'Ho Chi Minh', N'Binh Chanh', 0)
INSERT SINHVIEN VALUES (N'51603333', N'Lam Nhat', N'Ha', N'16050301', 0, CAST(0x000087BB00000000 AS DateTime), N'Đong Thap', N'Cao Lanh', 0)
INSERT SINHVIEN VALUES (N'51603211', N'Nguyen', N'Thanh', N'16050303', 1, CAST(0x00006C5500000000 AS DateTime), N'Ha Noi', N'11 Le Van Sy', 0)
INSERT SINHVIEN VALUES (N'51501236', N'Vo Tien', N'Phat', N'16050304', 1, CAST(0x00006CEB00000000 AS DateTime), N'Phu Yen', N'26 Phan Đinh Phung', 0)
INSERT SINHVIEN VALUES (N'41530211', N'Le Thi My', N'Van', N'16050302', 0, CAST(0x00006D0B00000000 AS DateTime), N'Lam Đong', N'Đa Lat', 0)
INSERT SINHVIEN VALUES (N'41605120', N'Tran Thuy', N'Hoa', N'16050301', 0, CAST(0x00006D2A00000000 AS DateTime), N'Binh Duong', N'2 Ly Chinh Thang', 0)
INSERT SINHVIEN VALUES (N'41605124', N'Nguyen Thi Yen', N'Nhi', N'16050310', 0, CAST(0x00006D4A00000000 AS DateTime), N'Khanh Hoa', N'14 Nguyen Van Linh',0)
GO
/** -----Tạo bảng DIEM----- **/
CREATE TABLE DIEM(
	MASV char(8) NOT NULL,
	MAMH char(6) NOT NULL,
	LAN smallint NOT NULL,
	DIEM float NOT NULL,
	PRIMARY KEY(MASV,MAMH,LAN),
)
GO
/** -----DIEM(MASV,MAMH,LAN,DIEM)----- **/
INSERT DIEM VALUES (N'51603330', N'501043', 1, 5)
INSERT DIEM VALUES (N'51603330', N'504068', 1, 4)
INSERT DIEM VALUES (N'51603330', N'502051', 2, 7)
INSERT DIEM VALUES (N'51603330', N'504076', 1, 5)
INSERT DIEM VALUES (N'51603330', N'504070', 2, 5)
INSERT DIEM VALUES (N'51603144', N'C01122', 1, 5)
INSERT DIEM VALUES (N'51603144', N'C01123', 1, 7)
INSERT DIEM VALUES (N'51603144', N'501044', 1, 10)
INSERT DIEM VALUES (N'51603333', N'501043', 1, 7)
INSERT DIEM VALUES (N'51603333', N'504068', 1, 7)
INSERT DIEM VALUES (N'51603211', N'502051', 1, 7)
INSERT DIEM VALUES (N'51603211', N'504076', 1, 7)
INSERT DIEM VALUES (N'51603211', N'504070', 1, 8)
INSERT DIEM VALUES (N'51501236', N'C01122', 1, 7)
INSERT DIEM VALUES (N'51501236', N'C01123', 1, 6)
INSERT DIEM VALUES (N'41530211', N'C01123', 1, 8)
INSERT DIEM VALUES (N'41530211', N'501044', 1, 8)
INSERT DIEM VALUES (N'41605120', N'501043', 1, 5)
INSERT DIEM VALUES (N'41605120', N'504068', 2, 8)
INSERT DIEM VALUES (N'41605124', N'502051', 1, 7)
GO

/** ----- Thêm foreign,check ----- **/
ALTER TABLE DIEM ADD  CONSTRAINT [CK_DIEM_DIEM] CHECK ((DIEM>=(0) AND DIEM<=(10)))
GO

ALTER TABLE DIEM ADD  CONSTRAINT [CK_DIEM_LAN] CHECK ((LAN=(1) OR LAN=(2)))
GO

ALTER TABLE DIEM ADD CONSTRAINT [FK_DIEM_MONHOC] FOREIGN KEY(MAMH) REFERENCES MONHOC(MAMH) ON UPDATE CASCADE
GO

ALTER TABLE SINHVIEN ADD CONSTRAINT [FK_SINHVIEN_LOP] FOREIGN KEY(MALOP) REFERENCES LOP (MALOP) ON UPDATE CASCADE
GO

ALTER TABLE LOP ADD CONSTRAINT [FK_LOP_KHOA] FOREIGN KEY(MAKH) REFERENCES KHOA(MAKH) ON UPDATE CASCADE
GO

ALTER TABLE DIEM ADD CONSTRAINT [FK_DIEM_SINHVIEN] FOREIGN KEY(MASV) REFERENCES SINHVIEN(MASV) ON UPDATE CASCADE
GO
